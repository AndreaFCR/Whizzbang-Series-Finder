"use strict";let series=[],favourites=[];const textInput=document.querySelector(".js-input"),createApiUrl=()=>"http://api.tvmaze.com/search/shows?q="+textInput.value,getDataFromApi=()=>{fetch("http://api.tvmaze.com/search/shows?q="+textInput.value).then(e=>e.json()).then(e=>{series=[];e.map(e=>series.push(e.show))})};textInput.addEventListener("keyup",getDataFromApi);const searchSeries=e=>{e.preventDefault(),paintSeries(),paintFavourites(),addBackgroundSearch()},searchBtn=document.querySelector(".js-searchBtn");searchBtn.addEventListener("click",searchSeries);const paintSeries=()=>{let e="";for(let t=0;t<series.length;t++)e+=`<article class="serie serieBackground js-serie " id=${series[t].id}>`,null!==series[t].image?e+=`<img src="${series[t].image.medium}" \n          class="serie__img" alt="Foto de la serie ${series[t].name}"/>`:e+=`<img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" \n          class="serie__img" alt="Foto de la serie ${series[t].name}"/>`,e+=`<h3 class="serie__title">${series[t].name}</h3>`,e+="</article>";const t=document.querySelector(".js-searchContainer"),s=document.querySelector(".js-searchTitle");t.innerHTML=e,0!==series.length&&(s.innerHTML="<h2>Resultados de la b√∫squeda:</h2>"),listenSeriesElements()},paintFavourites=()=>{let e="";0!==favourites.length&&(e+='<h2 class="title">Series favoritas ',e+='<span class="btnAll js-btnDeleteAll"}><i class="fa fa-window-close" aria-hidden="true"></i></<span></h2>');for(let t=0;t<favourites.length;t++)e+=`<article class="favourite js-favourite" id=${favourites[t].id}>`,null!==favourites[t].image?e+=`<img src="${favourites[t].image.medium}" \n          class="favourite__img" alt="Foto de la serie ${favourites[t].name}"/>`:e+=`<img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" \n          class="favourite__img" alt="Foto de la serie ${favourites[t].name}"/>`,e+=`<h3 class="favourite__title">${favourites[t].name}</h3>`,e+=`<div class="favourite__btn js-btnDelete" id=${favourites[t].id}><i class="fa fa-window-close" aria-hidden="true"></i></<div>`,e+="</article>";document.querySelector(".js-favContainer").innerHTML=e,listenResetBtn(),listenResetAllBtn(),listenSeriesElements()},addBackgroundSearch=()=>{for(const e of series)for(const t of favourites){let s=document.getElementById(e.id),a=t.id;e.id===a&&s.classList.add("serieBackgroundSelected")}},addBackgroundFavourite=e=>{document.getElementById(e.currentTarget.id).classList.add("serieBackgroundSelected")},addBackgroundNormal=e=>{document.getElementById(e.currentTarget.id).classList.remove("serieBackgroundSelected")},addBackgroundResetAll=()=>{for(const e of series){document.getElementById(e.id).classList.remove("serieBackgroundSelected")}},saveFavourites=e=>{const t=parseInt(e.currentTarget.id),s=series.find(e=>e.id===t);void 0===favourites.find(e=>e.id===t)&&favourites.push(s),updateLocalStorage(),paintFavourites(),addBackgroundFavourite(e)},listenSeriesElements=()=>{const e=document.querySelectorAll(".js-serie");for(let t=0;t<e.length;t++)e[t].addEventListener("click",saveFavourites)},resetFavourites=e=>{const t=parseInt(e.currentTarget.id),s=favourites.findIndex(e=>e.id===t);favourites.splice(s,1),updateLocalStorage(),paintFavourites(),addBackgroundNormal(e)},resetAllFavourites=()=>{favourites.splice(0,favourites.length),updateLocalStorage(),paintFavourites(),addBackgroundResetAll()},listenResetBtn=()=>{const e=document.querySelectorAll(".js-btnDelete");for(let t of e)t.addEventListener("click",resetFavourites)},listenResetAllBtn=()=>{const e=document.querySelector(".js-btnDeleteAll");null!==e&&e.addEventListener("click",resetAllFavourites)},updateLocalStorage=()=>{localStorage.setItem("favourites",JSON.stringify(favourites))},getFromLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("favourites"));null!==e&&(favourites=e)};getFromLocalStorage(),paintFavourites();